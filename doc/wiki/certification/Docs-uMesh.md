# AliOS Things uMesh测试规范
### Help指令

| 测试用例编号 | AOS-2-10                                                                                                                                                                                                                                                                                                                           |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Help指令                                                                                                                                                                                                                                                                                                                           |
| 测试目的     | 利用help查看mesh中所有支持的指令                                                                                                                                                                                                                                                                                                   |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                                                                                                                                                              |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                                                                                                                           |
| 测试拓扑结构 | 一个设备串口连接PC                                                                                                                                                                                                                                                                                                                 |
| 测试预置条件 | 设备进入mesh环境                                                                                                                                                                                                                                                                                                                   |
| 测试步骤     | 在设备的中输入umesh help                                                                                                                                                                                                                                                                                                           |
| 预期结果     | 列出所有支持的指令： <br>- extnetid——查看并设置mesh网络隔离地址，搭建不同的mesh环境 <br>- nbrs——打印节点探测到的邻居节点 <br>- start——开启mesh网络 <br>- stats——查看统计信息 <br>- status——查看此设备所有信息 <br>- stop——断开mesh网络 <br>- ipaddr——打印网络的ipv4地址（包括：子节点地址、全网广播地址） <br>- ping——ping网络中的节点（测试连通性） |
| 备注         | - 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- 被测设备与AP相对位置见 附录D：mesh测试设备与AP相对位置示意图                                                                                                                                                                                                                    |

### Status查看

| 测试用例编号 | AOS-2-11                                                       |
|--------------|----------------------------------------------------------------|
| 测试用例     | Status查看                                                     |
| 测试目的     | 查看设备相关信息：sid，mac，netid等                            |
| 测试属性     | 必选\| P2 \| 功能用例                                          |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                       |
| 测试拓扑结构 | 一个mesh网络：leader+router+router+ router，每种角色各一个设备 |
| 测试预置条件 | 按上面拓扑结构搭环境                                           |
| 测试步骤     | 在四个设备的console分别执行umesh status命令                    |
| 预期结果     | 显示设备的state、netid、mac、attach、netsize、 channel信息     |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                     |

### Neighbor发现功能

| 测试用例编号 | AOS-2-12                                                                                                                               |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Neighbor发现功能                                                                                                                       |
| 测试目的     | 验证网络中存在一个或多个设备时，Neighbor的发现功能是否正确                                                                             |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                  |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                               |
| 测试拓扑结构 | 一个设备或者多个设备串口连接PC                                                                                                         |
| 测试预置条件 | 设备进入mesh环境。                                                                                                                     |
| 测试步骤     | \- 网络中仅有leader ，在leader的 console执行umesh nbrs命令。 <br>- 新增一个或多个设备接入mesh网络，在各自设备的console执行umesh nbrs命令 |
| 预期结果     |- 无法查看neighbor信息 <br>- 每个设备都能发现网络中除自己以外的其他所有设备                                                                |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                             |

### 不同mesh网络间Neighbor信息隔离

| 测试用例编号 | AOS-2-13                                                                                                                                                         |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 不同mesh网络间Neighbor信息隔离                                                                                                                                   |
| 测试目的     | 验证不同mesh网络中查看neighbor是不是隔离                                                                                                                         |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                            |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                         |
| 测试拓扑结构 | \- 4个设备，每2个连接不同ap（两AP的ssid，pw，channel都不同），组建两个mesh网络A,网络B。 <br>- mesh网络A,网络B中，各配置一个leader，另一个router                    |
| 测试预置条件 | \- 按上面拓扑结构搭环境 <br>- 设备与路由器的相对位置见附录A                                                                                                             |
| 测试步骤     | \- 在四个设备的console分别执行umesh nbrs命令 <br>- 在四个设备的console分别执行umesh status命令                                                                     |
| 预期结果     | \- 每个设备只能发现一条neighbor信息，且该条neighbor信息为各自mesh网络中除自己之外的那个设备 <br>- A网络中两个设备的netid是X，B网络中两个设备的netid是Y，且X不等于Y |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                       |

### 同一个mesh网络meshnetid和meshnetsize一致性

| 测试用例编号 | AOS-2-14                                             |
|--------------|------------------------------------------------------|
| 测试用例     | 同一个mesh网络meshnetid和meshnetsize一致性           |
| 测试目的     | 验证同一个mesh网络内的meshnetid和meshnetsize是否一致 |
| 测试属性     | 必选\| P0 \| 功能用例                                |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC             |
| 测试拓扑结构 | 一个mesh网络：leader+router+router+ router           |
| 测试预置条件 | 按上面的拓扑结构部署环境                             |
| 测试步骤     | 四个设备的console均执行umesh status命令              |
| 预期结果     | 所有设备的netid和netsize一致                         |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）           |

### 查看IP地址

| 测试用例编号 | AOS-2-15                                                                                                                                                                                                           |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 查看IP地址                                                                                                                                                                                                         |
| 测试目的     | 查看设备的IP地址和广播地址                                                                                                                                                                                         |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                                              |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                           |
| 测试拓扑结构 | \- 有且只有一个mesh网络 <br>- 任何拓扑结构                                                                                                                                                                           |
| 测试预置条件 | 同上                                                                                                                                                                                                               |
| 测试步骤     | 在设备A的console输入：umesh ipaddr， <br>-  对于ipv6如下： <br> fc00:0:0:ff00:0:0:0:1000 <br> fc00:0:0:ff00:260a:c404:c944:0 <br>ff08:0:0:fffe:0:0:0:fc <br>-  对于ipv4如下： <br> 10.0.16.2 <br> 224.0.0.252         |
| 预期结果     | \- 对于ipv6：第一行是含有sid的IP地址（地址会变）， <br> 第二行是有mac地址的IP地址（即UEID地址，地址固定）， <br> 第三行是多播地址 <br>-  对于ipv4：第一行是本地地址，第二行是多播地址                                 |
| 备注         | - 本地IPv4地址和uMesh短地址之间映射关系：若本地地址是10.0.A.B，那么sid = (A \<\< 8 + B -2)；<br>若某一节点sid = 0x1000，那么对应的IPv4本地地址是10.0.16.2。 <br>- 802.15.4组网、BLE组网（此2种组网功能暂无） |

### Leader连AP，其它节点不连AP组网

| 测试用例编号 | AOS-2-16                                                                                                                                                            |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Leader连AP，其它节点不连AP组网                                                                                                                                      |
| 测试目的     | 验证Leader连AP，其它节点不连AP组网是否成功                                                                                                                          |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                               |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                            |
| 测试拓扑结构 | 拓扑结构随意                                                                                                                                                        |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                                          |
| 测试步骤     | 将leader节点配网成功，其它3个节点不连接AP                                                                                                                           |
| 预期结果     | 几分钟后，其它节点依然挂在leader节点下面，拓扑结构不变，节点间能ping通                                                                                              |
| 备注         | \- 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- 连接AP成功的节点必定成为mesh网络中的leader <br>- 后续均可以在一个节点连接AP成为leader，其他节点不连AP组网拓扑下测试 |

### Fixed模式—leader和router

| 测试用例编号 | AOS-2-17                                                                                                         |
|--------------|------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—leader和router                                                                                         |
| 测试目的     | 验证Fixed模式下leader和router的角色形成                                                                          |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                            |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                         |
| 测试拓扑结构 | 当前无任何mesh网络环境                                                                                           |
| 测试预置条件 | 准备设备A和B                                                                                                     |
| 测试步骤     | \- 设备A进入mesh环境，等一分钟 <br>- 设备B进入mesh环境，等一分钟 <br>- 在设备A的console中执行umesh nbrs              |
| 预期结果     | \- 设备Ａ默认成为leader节点 <br>- 设备Ｂ默认成为router节点 <br>- 能够看到设备B的macaddr和sid，且设备B在A的children中 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                       |

### Fixed模式—ping IP地址

| 测试用例编号 | AOS-2-18                                                                                                                                                                                                           |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—ping IP地址                                                                                                                                                                                              |
| 测试目的     | 验证fixed模式下所有节点是否都能相互ping通                                                                                                                                                                          |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                                              |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                           |
| 测试拓扑结构 | \- 当前只有一个mesh环境 <br>- 当前mesh网络中有一个leader和3个router（A，B和C）                                                                                                                                       |
| 测试预置条件 | 同上                                                                                                                                                                                                               |
| 测试步骤     | \- Leader分别ping其它三个router节点ping IP <br> 【例：ping 10.0.16.2（ipv4地址）或者ping fc00:0:0:6800:0:10（ipv6地址）】 <br>- Router A ping其它三个节点 <br>- Router B ping其它三个节点 <br>- Router C ping其它三个节点 |
| 预期结果     | \- 能够正常ping通，能收到对应节点回复打印 <br>- 能够正常ping通，能收到对应节点回复打印 <br>- 能够正常ping通，能收到对应节点回复打印 <br>- 能够正常ping通，能收到对应节点回复打印                                         |
| 备注         | \- 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- **目前暂只支持ipv4地址网络**                                                                                                                                     |

### Fixed模式—ping UEID地址

| 测试用例编号 | AOS-2-19                                                                                                                                                                                       |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—ping UEID地址                                                                                                                                                                        |
| 测试目的     | 验证fixed模式下所有节点用UEID是否都能相互ping通                                                                                                                                                |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                          |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                       |
| 测试拓扑结构 | \- 当前只有一个mesh环境 <br>- 当前mesh网络中有一个leader和3个router（A，B和C）                                                                                                                   |
| 测试预置条件 | 同上                                                                                                                                                                                           |
| 测试步骤     | \- leader节点分别ping其它三个router节点的UEID地址 <br>（例：ping fc00:0:0:6800:260a:c404:c944:0） <br>- Router A　ping其它三个节点 <br>- Router B　ping其它三个节点 <br>- Router C　ping其它三个节点 |
| 预期结果     | \- 能够正常ping通，能收到对应节点回复打印 <br>- 能够正常ping通，能收到对应节点回复打印 <br>- 能够正常ping通，能收到对应节点回复打印 <br>- 能够正常ping通，能收到对应节点回复打印                     |
| 备注         | \- 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- **此项只针对ipv6地址网络，目前暂只支持ipv4地址网络，故此用例跳过不测**                                                                                         |

### Fixed模式—多字节ping IP地址

| 测试用例编号 | AOS-2-20                                                                                                                                                                                                                              |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—多字节ping IP地址                                                                                                                                                                                                           |
| 测试目的     | 验证fixed模式下所有节点是否都能相互ping通                                                                                                                                                                                             |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                                                                 |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                              |
| 测试拓扑结构 | \- 当前只有一个mesh环境 <br>- 当前mesh网络中有１个leader和3个router（A，B和C）                                                                                                                                                          |
| 测试预置条件 | 同上                                                                                                                                                                                                                                  |
| 测试步骤     | \- leader节点分别ping其它三个router节点ping IP X <br>【例：ping 10.0.16.2 1000（ipv4地址）或者 ping fc00:0:0:6800:0:1000 1000（ipv6地址）】 <br>- Router A ping其它三个节点 <br>- Router B ping其它三个节点 <br>- Router C ping其它三个节点 |
| 预期结果     | \- 能够正常ping通，能收到对应节点回复打印 <br>- 能够正常ping通，能收到对应节点回复打印 <br>- 能够正常ping通，能收到对应节点回复打印 <br>- 能够正常ping通，能收到对应节点回复打印                                                            |
| 备注         | \- ping IP X此处的X为多字节，最大值是1492 <br>- 802.15.4组网下再测一次 <br>- **目前暂只支持ipv4地址网络**                                                                                                                                 |

### Fixed模式—多字节ping UEID地址

| 测试用例编号 | AOS-2-21                                                                                                                                                                                             |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—多字节ping UEID地址                                                                                                                                                                        |
| 测试目的     | 验证fixed模式下所有节点用UEID多字节是否都能相互ping通                                                                                                                                                |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                                |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                             |
| 测试拓扑结构 | \- 当前只有一个mesh环境 <br>- 当前mesh网络中有１个leader和3个router（A，B和C）                                                                                                                         |
| 测试预置条件 | 同上                                                                                                                                                                                                 |
| 测试步骤     | \- leader节点ping分别ping其它三个router节点的UEID地址 <br>（例：ping fc00:0:0:6800:260a:c404:c944:0 1000） <br>- Router A ping其它三个节点 <br>- Router B ping其它三个节点 <br>- Router C ping其它三个节点 |
| 预期结果     | \- 能够正常ping通，能收到对应节点回复打印 <br>- 能够正常ping通，能收到对应节点回复打印 <br>- 能够正常ping通，能收到对应节点回复打印 <br>- 能够正常ping通，能收到对应节点回复打印                           |
| 备注         | \- ping fc00:0:0:6800:260a:c404:c944:0 1000为多字节，最大值是1492； <br>- 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- **此项只针对ipv6地址网络，目前暂只支持ipv4地址网络，故此用例跳过不测**                          |

### Fixed模式—ping多字节的极限值测试

| 测试用例编号 | AOS-2-22                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—ping多字节的极限值测试                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 测试目的     | 验证fixed模式下ping最大值字节，和超过最大值是否正常                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 测试拓扑结构 | \- 当前只有一个mesh环境 <br>- 当前mesh网络中有１个leader和3个router（A，B和C）                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 测试预置条件 | 同上                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 测试步骤     | \- 任一节点分别用最大值字节ping其它三个节点【例：ping 10.0.16.2 1492（ipv4地址） 或者 ping fc00:0:0:6800:0:1000 1492（ipv6地址）】 <br>- 任一节点分别用超过最大值字节ping其它三个节点【例：ping 10.0.16.2 1493（ipv4地址）或者 ping fc00:0:0:6800:0:1000 1493（ipv6地址）】 <br>- 任一节点分别用最大值字节ping其它三个节点的UEID地址（例：ping fc00:0:0:6800:260a:c404:c944:0 1492） <br>- 任一节点分别用超过最大值字节ping其它三个节点的UEID地址（例：ping fc00:0:0:6800:260a:c404:c944:0 1493） |
| 预期结果     | \- 能够正常ping通，能收到对应节点回复打印 <br>- 不能够ping通，提示“exceed mesh IP MTU 1500” <br>- 能够正常ping通，能收到对应节点回复打印 <br>- 不能够ping通，提示“exceed mesh IP MTU 1500”                                                                                                                                                                                                                                                                                                                |
| 备注         | \- 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- **目前暂只支持ipv4地址网络**                                                                                                                                                                                                                                                                                                                                                                                                                      |

### Fixed模式—全网发送广播包（多播）

| 测试用例编号 | AOS-2-23                                                                                                                                                                         |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—全网发送广播包（多播）                                                                                                                                                 |
| 测试目的     | 验证各节点全网发送广播包能否成功                                                                                                                                                 |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                            |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                         |
| 测试拓扑结构 | \- 当前周边已有且只有一个构建的mesh网络 <br>- 当前mesh网络中有一个leader节点和3个router节点                                                                                                                                |
| 测试预置条件 | 同上                                                                                                                                                                             |
| 测试步骤     | \- 每个节点上分别执行ping 224.0.0.252 <br>- 每个节点上执行指定长度的广播，执行命令是ping 224.0.0.252 X（ipv4地址）或者ping ff08:0:0:fffe:0:0:0:fc X（ipv6地址） <br>- 步骤2执行100次 |
| 预期结果     | \- 能够正常ping通，能收到所有节点回复打印 <br>- 能够正常ping通，能收到所有节点回复打印。 <br>- 能够正常ping通，能收到所有节点回复打印，丢包率不得高于**20%**（待定）                 |
| 备注         | \- X为字节长度，范围在1\~1492 <br>- 丢包率与硬件WiFi底层相关 <br>- 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- **目前暂只支持ipv4地址网络**                                       |

### Fixed模式—router节点回收

| 测试用例编号 | AOS-2-24                                                                                                                                               |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—router节点回收                                                                                                                               |
| 测试目的     | 验证router节点能否回收                                                                                                                                 |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                  |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                               |
| 测试拓扑结构 | \- 当前周边已有且只有一个构建的mesh网络<br> - 当前mesh网络中有一个leader节点（sid:0x0），3个router节点（sid分别为1000,2000和3000）                                                               |
| 测试预置条件 | \- 按照上面的拓扑结构搭建环境 <br>- 另外准备一个设备X备用                                                                                                |
| 测试步骤     | \- sid为XXXX的节点A的console执行umesh stop，等待五分钟 <br>- 设备X进入该mesh网络，在其console中执行umesh status                                          |
| 预期结果     | \- 其他某个节点console输入umesh nbrs，发现节点A已不在nbrs列表 <br>- 设备X的节点sid为XXXX，且其他节点console输入umesh nbrs，能够发现设备X的sids显示是XXXX |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                             |

### Fixed模式—Router节点stop再start后的角色变化

| 测试用例编号 | AOS-2-25                                                                                                                              |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—Router节点stop再start后的角色变化                                                                                           |
| 测试目的     | 验证router节点断开再连接后的角色变化                                                                                                  |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                 |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                              |
| 测试拓扑图   | \- 当前周边已有且只有一个构建的mesh网络  <br>- 当前mesh网络中有一个leader节点（sid:0x0），2个router节点（sid分别为1000，2000）                                                   |
| 测试预置条件 | \- 按照上面的拓扑结构搭建环境 <br>- 另外准备一个设备S备用                                                                               |
| 测试步骤     | \- sid为XXXX的router节点执行stop命令，2分钟内接入新的设备S <br>- 原sid为XXXX的router节点执行start命令                                   |
| 预期结果     | \- 成为新的router，且sid获取为0x3000，其他节点ping此节点能够ping通 <br>- sid为XXXX的节点start后仍然是XXXX，其他节点ping此节点能够ping通 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                            |

### Fixed模式—Leader节点stop后再start的角色变化(Leader连AP)

| 测试用例编号 | AOS-2-26                                                                                                                                                                                                   |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—Leader节点stop后再start的角色变化(Leader连AP)                                                                                                                                                    |
| 测试目的     | 验证leader节点断开后再连接的节点角色变化                                                                                                                                                                   |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                                                                      |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                   |
| 测试拓扑结构 | 1个mesh网络：1个leader，3个router                                                                                                                                                                          |
| 测试预置条件 | \- 有且只有一个mesh网络 <br>- 按照上面的拓扑结构部署环境                                                                                                                                                     |
| 测试步骤     | \- leader节点执行umesh stop命令，等待5分钟 <br>- leader节点执行umesh start命令，等待8分钟左右 <br>- leader节点执行stop命令，不到1分钟后再执行start命令，等待8分钟                                              |
| 预期结果     | \- 原先3个router节点会选举出一个节点成为leader节点，其他节点ping此节点能够ping通； <br>- 原leader节点再次变成leader节点，其它节点会挂在这个leader下面，节点间能够相互ping通 <br>- 拓扑不变，节点间能相互ping通 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                                                                 |

### Fixed模式—Leader节点stop后再start的角色变化(Leader未连AP)

| 测试用例编号 | AOS-2-27                                                                                                                                                  |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—Leader节点stop后再start的角色变化(Leader未连AP)                                                                                                 |
| 测试目的     | 验证leader节点断开后再连接的节点角色变化                                                                                                                  |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                     |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                  |
| 测试拓扑结构 | 1个mesh网络：1个leader，3个router                                                                                                                         |
| 测试预置条件 | \- 有且只有一个mesh网络 <br>- 按照上面的拓扑结构部署环境                                                                                                    |
| 测试步骤     | \- leader节点执行umesh stop命令，等待5分钟 <br>- leader节点执行umesh start命令                                                                              |
| 预期结果     | \- 原先3个router节点会选举出一个节点成为leader节点，其他节点ping此节点能够ping通； <br>- 原leader节点重新接入后变为router节点，其他节点ping此节点能够ping通 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                |

### 改变AP的channel，所有设备仍然在同一个mesh网络中

| 测试用例编号 | AOS-2-28                                                                                      |
|--------------|-----------------------------------------------------------------------------------------------|
| 测试用例     | 改变AP的channel，所有设备仍然在同一个mesh网络中                                               |
| 测试目的     | 验证AP channel的改变，所有设备的channel也会跟着变化                                           |
| 测试属性     | 必选\| P1 \| 功能用例                                                                         |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                      |
| 测试拓扑结构 | \- 所有设备都连接同一个AP <br>- 设备的拓扑模式Leader+3router                                    |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                    |
| 测试步骤     | \- 设备都进入mesh环境 <br>- 更改AP的channel值，保存。 <br>- 等待一段时间后，查看各设备的channel值 |
| 预期结果     | 设备的channel都为更改后的值，且所有设备的meshnetid是相同的，各节点间也能ping通                |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                    |

### Mesh网中的两个节点都连AP后拓扑结构的变化

| 测试用例编号 | AOS-2-29                                                                           |
|--------------|------------------------------------------------------------------------------------|
| 测试用例     | Mesh网中的两个节点都连AP后拓扑结构的变化                                           |
| 测试目的     | 验证Mesh网中的两个节点都连AP后拓扑结构的变化                                       |
| 测试属性     | 必选\| P1 \| 功能用例                                                              |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                           |
| 测试拓扑结构 | 1个mesh网络：1个Leader，多个router                                                 |
| 测试预置条件 | \- 按上面拓扑结构搭建环境 <br>- 确保没有节点连上AP                                   |
| 测试步骤     | 将leader节点A和某个router（或者super router）B都连上AP                           |
| 预期结果     | 一段时间后，A和B各自成为leader节点，剩下的节点都挂在A或者B，或者各自挂在AB下面均可 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                         |

### 两个mesh网络-设备的距离与网络合并无关联性

| 测试用例编号 | AOS-2-30                                                                           |
|--------------|------------------------------------------------------------------------------------|
| 测试用例     | 两个mesh网络-设备的距离与网络合并无关联性                                          |
| 测试目的     | 验证不同的mesh网络的设备放在一起会不会发生网络合并                                 |
| 测试属性     | 必选\| P2 \| 功能用例                                                              |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                           |
| 测试拓扑结构 | 两个mesh网络环境A和B（A和B的channel不同） A和B中各有一个设备                       |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                         |
| 测试步骤     | 将这两块设备放到一起                                                               |
| 预期结果     | 依然各自维持各自的mesh网络，分别在console中输入umesh status，显示各自的网络的netid |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                         |

### 两个mesh网络-不同mesh网络的设备之间无法ping通

| 测试用例编号 | AOS-2-31                                                                                                                                                                                                 |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 两个mesh网络-不同mesh网络的设备之间无法ping通                                                                                                                                                            |
| 测试目的     | 验证不同mesh网络的设备之间无法ping通                                                                                                                                                                     |
| 测试属性     | 必选\| P2 \| 功能性用例                                                                                                                                                                                  |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                 |
| 测试拓扑结构 | \- 当前周边已有两个mesh网络A和B（A和B的channel不同） <br>- mesh网络A中有一个leader节点，2个routerX1、X2、X3节点（1000、2000、3000） <br>- mesh网络B中有一个leader节点，3个router节点Y1、Y2节点（1000、2000） |
| 测试预置条件 | 同上                                                                                                                                                                                                     |
| 测试步骤     | \- 在网络A中节点X3的console中输入umesh ipaddr获取X3的IP <br>- mesh网络B中的节点Y1去ping网络A中的节点X3                                                                                                     |
| 预期结果     | 无法ping通                                                                                                                                                                                               |
| 备注         | \- 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- 因ipv4网络中的所有相同的sid的ip地址都是一样，故用这种方法对比                                                                                          |

### 两个mesh网络-AP断电不会影响其他mesh环境

| 测试用例编号 | AOS-2-32                                                                                                                                |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 两个mesh网络-AP断电不会影响其他mesh环境                                                                                                 |
| 测试目的     | 验证AP断电不会影响其他mesh环境                                                                                                          |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                   |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                |
| 测试拓扑结构 | \- 设备连接两个不同的路由器，形成两个不同的mesh网络A和B <br>- A和B的拓扑结构分别都是leader+router                                         |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                              |
| 测试步骤     | \- 4个设备都执行umesh status <br>- 断开A网络的AP电源, 4个设备都执行umesh status                                                        |
| 预期结果     | \- A网络中设备netid值为X，B网络中设备netid值为Y <br>- A网络中设备netid可能会发生变化，B网络中设备netid值仍为Y。A网络的断网不会影响到B网络 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                              |

### 距离测试—设备之间超出AP覆盖范围会各自成为leader

| 测试用例编号 | AOS-2-33                                                            |
|--------------|---------------------------------------------------------------------|
| 测试用例     | 距离测试—设备之间超出AP覆盖范围会各自成为leader                     |
| 测试目的     | 验证设备之间超出AP覆盖范围是否会各自成为leader                      |
| 测试属性     | 必选\| P2 \| 功能用例                                               |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                            |
| 测试拓扑结构 | 一个mesh环境：网络中有一个leader和一个router S                      |
| 测试预置条件 | 同上                                                                |
| 测试步骤     | 两个设备的距离拉远到设备S检测不到leader                             |
| 预期结果     | 设备S自己会成为leader，在console中输入umesh status显示state为leader |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                          |

### 距离测试—相隔10米的设备之间能进行通信

| 测试用例编号 | AOS-2-34                                                   |
|--------------|------------------------------------------------------------|
| 测试用例     | 距离测试—相隔10米的设备之间能进行通信                      |
| 测试目的     | 验证相隔10米的设备之间能否进行通信                         |
| 测试属性     | 必选\| P2 \| 功能用例                                      |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                   |
| 测试拓扑结构 | \- 当前周边已有且只有一个构建的mesh网络  <br>- 任何拓扑                                               |
| 测试预置条件 | 节点设备之间相隔10米远                                     |
| 测试步骤     | \- 在节点B上输入umesh ipaddr获取IP地址 <br>- 节点A ping节点B |
| 预期结果     | 能够正常ping通，能收到对应节点回复打印                     |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                 |

### 白名单—新增设备设置白名单后，会挂在白名单列表的设备下

| 测试用例编号 | AOS-2-35                                                                                                                                                                                                                                    |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 白名单—新增设备设置白名单后，会挂在白名单列表的设备下                                                                                                                                                                                       |
| 测试目的     | 验证新加入设备设置白名单后，是否会挂在白名单列表的设备下                                                                                                                                                                                    |
| 测试属性     | 必选\| P2 \| 功能用例                                                                                                                                                                                                                       |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                                    |
| 测试拓扑结构 | \- 当前周边已有且只有一个构建的mesh网络<br>- 当前mesh网络中有一个leader节点和一个router节点                                                                                                                                                                                          |
| 测试预置条件 | \- 按照上面拓扑结构搭建环境 <br>- 准备一个新设备S备用                                                                                                                                                                                         |
| 测试步骤     | \- 在节点X和新设备S的console中输入mac获取X、S的mac地址：M、N <br>- 新设备S在console中whitelist add M（不要加符号）；节点X在console中whitelist add N（不要加符号）<br>- 在节点X和新设备S的console中输入whitelist enable                                                                                                                                                                                         |
| 预期结果     | 新加入的设备会挂在节点X下面，在节点Ｘ的console输入umesh nbrs，可以看到新加入的设备                                                                                                                                                          |
| 备注         | \- 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- 保险起见输入完whitelist enable后，都需要重启mesh，即umesh stop再umesh start（此结论待定） <br>- 白名单功能只是辅助测试的工具，用于搭建复杂网络（即多跳节点） <br>- **功能暂无，后期添加完善** |

### 白名单—白名单为空时enable白名单会消息闭塞

| 测试用例编号 | AOS-2-36                                                                                                                                                                                                                                    |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 白名单—白名单为空时enable白名单会消息闭塞                                                                                                                                                                                                   |
| 测试目的     | 验证enable空白名单后，侦听不到任何消息                                                                                                                                                                                                      |
| 测试属性     | 必选\| P2 \| 功能用例                                                                                                                                                                                                                       |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                                    |
| 测试拓扑图   | \- 当前周边已有且只有一个构建的mesh网络 <br>- 当前mesh网络中有一个leader节点和一个router节点                                                                                                                                                                                          |
| 测试预置条件 | 同上                                                                                                                                                                                                                                        |
| 测试步骤     | \- 在router节点A上的console中输入whitelist enable（白名单里面为空） <br>- 在其他节点上广播：ping 224.0.0.252（ipv4地址）或者ping ff08:0:0:fffe:0:0:0:fc（ipv6地址） <br>- 节点A上输入whitelist disable，等2分钟                                 |
| 预期结果     | \- 等待一段时间后，节点A会成为leader <br>- 无法收到A节点的回复打印 <br>- 节点A会恢复成之前的router                                                                                                                                              |
| 备注         | \- 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- 保险起见输入完whitelist enable后，都需要重启mesh，即umesh stop再umesh start（此结论待定） <br>- 白名单功能只是辅助测试的工具，用于搭建复杂网络（即多跳节点） <br>- **功能暂无，后期添加完善** |

### 白名单—白名单不为空时enable白名单会收到消息

| 测试用例编号 | AOS-2-37                                                                                                                                                                                                                                    |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 白名单—白名单不为空时enable白名单会收到消息                                                                                                                                                                                                 |
| 测试目的     | 验证白名单不为空时enable白名单后广播能否收到                                                                                                                                                                                                |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                                                                                                       |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                                    |
| 测试拓扑结构 | \- 有且只有一个mesh网络 <br>- 一个leader和2个（或者3个）router                                                                                                                                                                                |
| 测试预置条件 | 同上                                                                                                                                                                                                                                        |
| 测试步骤     | \- A与B互加白名单 <br>- 在其他节点上（非A，B节点）广播 <br>- 节点B上输入whitelist disable，等2分钟后节点A上输入sids，leader节点下输入sids                                                                                                    |
| 预期结果     | \- 节点B会成为节点A的子节点 <br>- 能收到B节点的回复打印 <br>- 节点B不会挂在A下面，直接挂在leader下面                                                                                                                                            |
| 备注         | \- 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- 保险起见输入完whitelist enable后，都需要重启mesh，即umesh stop再umesh start（此结论待定） <br>- 白名单功能只是辅助测试的工具，用于搭建复杂网络（即多跳节点） <br>- **功能暂无，后期添加完善** |

### 白名单—将leader加入白名单后可侦听到广播

| 测试用例编号 | AOS-2-38                                                                                                                                                                                                                                    |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 白名单—将leader加入白名单后可侦听到广播                                                                                                                                                                                                     |
| 测试目的     | 验证将leader加入白名单后是否可侦听到广播                                                                                                                                                                                                    |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                                                                                                       |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                                    |
| 测试拓扑结构 | \- 有且只有一个mesh网络 <br>- 一个leader和2个（或者3个）router                                                                                                                                                                                |
| 测试预置条件 | 同上                                                                                                                                                                                                                                        |
| 测试步骤     | \- 在leader节点上输入macaddr获取mac地址 M ，在router节点X上输入whitelist enable（白名单里面为空），再 输入whitelist add M （不要加符号） <br>- 在其它节点上（非X和leader节点）广播                                                                                                                                                                                                     |
| 预期结果     | \- 节点x会成为该leader的子节点 <br>- X能听到消息                                                                                                                                                                                              |
| 备注         | \- 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- 保险起见输入完whitelist enable后，都需要重启mesh，即umesh stop再umesh start（此结论待定） <br>- 白名单功能只是辅助测试的工具，用于搭建复杂网络（即多跳节点） <br>- **功能暂无，后期添加完善** |

### 白名单—关闭白名单功能拓扑结构会相应改变

| 测试用例编号 | AOS-2-39                                                                                                                                                                                                                                    |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 白名单—关闭白名单功能拓扑结构会相应改变                                                                                                                                                                                                     |
| 测试目的     | 验证将白名单功能关闭后是否会改变拓扑结构                                                                                                                                                                                                    |
| 测试属性     | 必选\| P3 \| 功能用例                                                                                                                                                                                                                       |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                                    |
| 测试拓扑结构 | \- 有且只有一个mesh网络 <br>- 1个leader+多个router                                                                                                                                                                                            |
| 测试预置条件 | 同上                                                                                                                                                                                                                                        |
| 测试步骤     | \- 在节点A上输入whitelist enable（白名单里面为空） <br>- 在A的console中输入 whitelist disable <br>- 在A的console中输入whitelist enable，再输入whitelist add M （不要加符号，M为节点B的mac地址） <br>- 在A的console中输入 whitelist disable        |
| 预期结果     | \- 等待2分钟后，节点A会成为leader <br>- 等待2分钟后，节点A会成为router <br>- 等待2分钟后，A成为B的子节点，B的console中输入umesh nbrs，可以看到A <br>- 等待2分钟后，A不再是B的子节点，B的console中输入umesh nbrs，可以看不到A                      |
| 备注         | \- 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- 保险起见输入完whitelist enable后，都需要重启mesh，即umesh stop再umesh start（此结论待定） <br>- 白名单功能只是辅助测试的工具，用于搭建复杂网络（即多跳节点） <br>- **功能暂无，后期添加完善** |

### 802.15.4组网—mac查看

| 测试用例编号 | AOS-2-40                                                                                                                                                                                                                                                                                        |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 802.15.4组网—mac查看                                                                                                                                                                                                                                                                            |
| 测试目的     | 查看设备mac地址                                                                                                                                                                                                                                                                                 |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                                                                                                                           |
| 测试设备     | 1.终端设备，2.无线路由器，3.PC ，4. CC2520 802.15.4模组，5.串口线                                                                                                                                                                                                                               |
| 测试拓扑结构 | leader+router                                                                                                                                                                                                                                                                                   |
| 测试预置条件 | \- CC2520 802.15.4模组正确连接上ESP32模组 <br>- 设备上电，在ysh中输入test conf yoc.cmdline --mesh-interface,4（这个命令用于使能设备使用802.15.4组网，<br>- 若是想要是设备使用WiFi，则在ysh中输入命令test conf yoc.cmdline --mesh-interface,1） <br>- 重启设备，在ysh中输入ur，init，start进入mesh环境 |
| 测试步骤     | 在某节点的console中输入macaddr                                                                                                                                                                                                                                                                  |
| 预期结果     | 例如显示3f:58:00:00:00:00:00:00                                                                                                                                                                                                                                                                         |
| 备注         | \- 802.15.4只有macaddr和WiFi不同，其他的都一样 <br>- 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                                                                                                   |

### 802.15.4组网—功能测试

| 测试用例编号 | AOS-2-41                                                                                                                                                                                                                                                                                        |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 802.15.4组网—功能测试                                                                                                                                                                                                                                                                           |
| 测试目的     | 验证802.15.4组网下的各项功能是否正常                                                                                                                                                                                                                                                            |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                                                                                                                           |
| 测试设备     | 1.设备，2.无线路由器，3.PC ，4. CC2520 802.15.4模组，5.串口线                                                                                                                                                                                                                                   |
| 测试拓扑结构 | leader+router                                                                                                                                                                                                                                                                                   |
| 测试预置条件 | \- CC2520 802.15.4模组正确连接上ESP32模组 <br>- 设备上电，在ysh中输入test conf yoc.cmdline --mesh-interface,4（这个命令用于使能设备使用802.15.4组网，<br>- 若是想要是设备使用WiFi，则在ysh中输入命令test conf yoc.cmdline --mesh-interface,1） <br>- 重启设备，在ysh中输入ur，init，start进入mesh环境 |
| 测试步骤     | 802.11上的基础功能均测试一遍                                                                                                                                                                                                                                                                    |
| 预期结果     | 所有结果均pass                                                                                                                                                                                                                                                                                  |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                                                                                                                                                      |

### AP断网—mesh网络中AP断网不会影响网络

| 测试用例编号 | AOS-2-42                                                                                                                                        |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | AP断网—mesh网络中AP断网不会影响网络                                                                                                             |
| 测试目的     | 验证mesh网络中AP断网是否会影响网络                                                                                                              |
| 测试属性     | 必选\| P2 \| 功能用例                                                                                                                           |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                        |
| 测试拓扑结构 | \- 设备配网成功 <br>- mesh网络的拓扑结构Leader+3router                                                                                            |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                      |
| 测试步骤     | \- 断开AP的网络 ，查看各个节点的netid <br>- 节点之间相互ping <br>- 节点发送广播 <br>- 连上AP网络                                                    |
| 预期结果     | \- mesh环境存在，所有节点的netid相同且较断开AP前没有改变 <br>- 节点之间能够相互ping通 <br>- 节点都能收到广播消息 <br>- 拓扑结构不变，节点间相互ping通 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                      |

### AP断电—路由器AP断电后5分钟内上电mesh网络正常

| 测试用例编号 | AOS-2-43                                                   |
|--------------|------------------------------------------------------------|
| 测试用例     | AP断电—路由器AP断电后5分钟内上电mesh网络正常               |
| 测试目的     | 验证路由器AP断电后5分钟内上电mesh网络正常                  |
| 测试属性     | 必选\| P0 \| 功能用例                                      |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                   |
| 测试拓扑结构 | \- 设备配网成功 <br>- mesh网络的拓扑结构Leader+3router       |
| 测试预置条件 | 同上                                                       |
| 测试步骤     | 路由器断电，5分钟后路由器上电，等待5分钟             |
| 预期结果     | 设备能连上网络，且mesh网络存在，节点A ping 节点B能够ping通 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                 |

### 路由器级联拓扑—断开级联路由器电源后mesh网络存在并能进行通信

| 测试用例编号 | AOS-2-44                                                                                                                                                                               |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 路由器级联拓扑—断开级联路由器电源后mesh网络存在并能进行通信                                                                                                                            |
| 测试目的     | 验证断开级联路由器电源后mesh网络存在并能进行通信                                                                                                                                       |
| 测试属性     | 必选\| P2 \| 功能用例                                                                                                                                                                  |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                               |
| 测试拓扑结构 | \- 两个路由器级联，A连外网，B级联A，A和B均设置成相同的SSID，PW和channel <br>- 所有设备均成功配网至级联网络 <br>- 设备的拓扑模式Leader+3router                                              |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                                                             |
| 测试步骤     | \- 断开路由器B电源 <br>- 插上路由器B电源 <br>- 断开路由器A电源 <br>- 插上路由器A电源                                                                                                         |
| 预期结果     | \- 所有设备会先断网一会，然后自动联网成功，此时mesh环境存在，设备之间也能相互ping通 <br>- mesh环境存在，设备之间也能相互ping通 <br>- mesh环境存在 <br>- mesh环境存在，设备之间也能相互ping通 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                                             |

### WDS环境—断开副路由器电源后mesh网络存在并能进行通信

| 测试用例编号 | AOS-2-45                                                                                                                                                                               |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | WDS环境—断开副路由器电源后mesh网络存在并能进行通信                                                                                                                                     |
| 测试目的     | 验证断开副路由器电源后mesh网络存在并能进行通信                                                                                                                                         |
| 测试属性     | 必选\| P2 \| 功能用例                                                                                                                                                                  |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                               |
| 测试拓扑结构 | \- 两个路由器级联，A连外网，B级联A，A和B均设置成相同的SSID，PW和channel，两个路由器通过WDS连接 <br>- 所有设备均成功配网至级联网络B <br>- 设备的拓扑模式Leader+3router                      |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                                                             |
| 测试步骤     | \- 断开路由器B电源 <br>- 插上路由器B电源 <br>- 断开路由器A电源 <br>- 插上路由器A电源                                                                                                         |
| 预期结果     | \- 所有设备会先断网一会，然后自动联网成功，此时mesh环境存在，设备之间也能相互ping通 <br>- mesh环境存在，设备之间也能相互ping通 <br>- mesh环境存在 <br>- mesh环境存在，设备之间也能相互ping通 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                                             |

### Alink_umesh gateway服务

| 测试用例编号 | AOS-2-46                                                                                                                                                                                                                                                                                                                                                                                           |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Alink_umesh gateway服务                                                                                                                                                                                                                                                                                                                                                                            |
| 测试目的     | 验证gateway为mesh节点提供上云服务                                                                                                                                                                                                                                                                                                                                                                  |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                                                                                                                                                                                                                              |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                                                                                                                                                                                           |
| 测试拓扑结构 | 1.设备的拓扑模式Leader+3router                                                                                                                                                                                                                                                                                                                                                                     |
| 测试预置条件 | \- 手机下载厂测包 <br>- 按上面拓扑结构搭建环境                                                                                                                                                                                                                                                                                                                                                       |
| 测试步骤     | \- 起leader设备A,连接AP，成功连上alink，获取设备的UUID，绑定激活成功，APP端查看设备A在线，起子节点设备，不连接AP，等待几分钟 <br>- APP端进入认证---新建测试认证---选择A设备，点击进入 <br>- 在某个子设备B的console端执行gateway login，在APP端选择子设备B，下一步---选择性能测试---选择2pps，点击执行 <br>- 点击停止，重启leader设备（或者stop再start），重复步骤5 <br>- 重启B（或者stop 再start B） |
| 预期结果     |- 拓扑结构形成 <br>- 子设备全部显示出来 <br>- 设备A和B都会出现云端下发消息的打印 <br>- 设备A和B都会出现云端下发消息的打印 <br>- 设备A和B都会出现云端下发消息的打印                                                                                                                                                                                                                              |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                                                                                                                                                                                                                                                         |

### 性能测试—低频指令压测（2pps）

| 测试用例编号 | AOS-2-47                                                                                                              |
|--------------|-----------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 性能测试—低频指令压测（2pps）                                                                                         |
| 测试目的     | 验证子节点与父节点通信响应低频业务指令处理能力                                                                        |
| 测试属性     | 必选\| P0 \| 性能用例                                                                                                 |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                              |
| 测试拓扑结构 | Leader配网绑定成功，拓扑结构随意（例如：leader+4router） 【0x0（连接AP）+0x1000+0x2000+0x2100+0x3000】                |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                            |
| 测试步骤     | 对拓扑的2级子节点（例如：0x2100）进行2pps的测试                                                                       |
| 预期结果     | APP端测试结果显示pass，且拓扑结构没有变化，节点间也能相互ping通                                                       |
| 备注         | \- 此项搭建多级子节点上测试，如无此环境，则换成1级子节点测试（0x2000） <br>- 802.15.4组网、BLE组网（此2种组网功能暂无） |

### 长时间测试—节点间长时间ping仍能通信

| 测试用例编号 | AOS-2-48                                                                                                                      |
|--------------|-------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 长时间测试—节点间长时间ping仍能通信                                                                                           |
| 测试目的     | 验证节点间长时间ping后仍能通信                                                                                                |
| 测试属性     | 必选\| P1 \| 性能用例                                                                                                         |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                      |
| 测试拓扑结构 | \- 有且只有一个mesh网络 <br>- 设备的拓扑模式Leader+3router                                                                      |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                    |
| 测试步骤     | \- 节点A和节点B ping 12h <br>- 所有节点相互ping <br>- 所有节点广播一下                                                            |
| 预期结果     | \- mesh环境存在，所有节点console输入umesh status，网络netid没变且一致 <br>- 设备之间也能相互ping通 <br>- 所有节点均能收到广播消息 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                    |

### 长时间测试—AP连续断电上电一晚上后mesh网络存在

| 测试用例编号 | AOS-2-49                                                                                                                                            |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 长时间测试—AP连续断电上电一晚上后mesh网络存在                                                                                                       |
| 测试目的     | 验证AP连续断电上电一晚上后mesh网络存在                                                                                                              |
| 测试属性     | 必选\| P1 \| 性能用例                                                                                                                               |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                            |
| 测试拓扑结构 | \- leader连接AP，其它节点不连接AP <br>- 设备的拓扑模式Leader+3router                                                                                  |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                          |
| 测试步骤     | \- 所有设备都上电，且都处于mesh环境中 <br>- 将AP电源反复断开连接持续12h后，AP电源上电 <br>- 等待一段时间后， 查看所有设备的channel，netid，netsize和sid |
| 预期结果     | 设备的channel， netid，netsize是一致，sid也没有冲突，节点间能相互ping通                                                                             |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                          |

### 长时间测试—AP长时间断电再上电后mesh网络存在

| 测试用例编号 | AOS-2-50                                                                                                                                                |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 长时间测试—AP长时间断电再上电后mesh网络存在                                                                                                             |
| 测试目的     | 验证AP长时间断电再上电后mesh网络存在                                                                                                                    |
| 测试属性     | 必选\| P1 \| 性能用例                                                                                                                                   |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                |
| 测试拓扑结构 | \- leader连接AP，其它节点不连接AP <br>- 设备的拓扑模式Leader+3router                                                                                      |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                              |
| 测试步骤     | \- 所有设备都上电，且都处于同一个mesh环境中 <br>- 将AP电源长时间断开12h后，再给AP电源上电 <br>- 等待一段时间后， 查看所有设备的channel，netid，netsize和sid |
| 预期结果     | 设备的channel， netid，netsize是一致，sid也没有冲突，节点间能相互ping通                                                                                 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                              |

### 长时间测试—AP连续断网再连网一晚上后mesh网络存在

| 测试用例编号 | AOS-2-51                                                                                                                                            |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 长时间测试—AP连续断网再连网一晚上后mesh网络存在                                                                                                     |
| 测试目的     | 验证AP连续断网再连网一晚上后mesh网络存在                                                                                                            |
| 测试属性     | 必选\| P1 \| 性能用例                                                                                                                               |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                            |
| 测试拓扑结构 | \- leader连接AP，其它节点不连接AP <br>- 设备的拓扑模式Leader+3router                                                                                  |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                          |
| 测试步骤     | \- 所有设备都上电，且都处于mesh环境中 <br>- 将AP网络反复断开连接持续12h后，AP连接网络 <br>- 等待一段时间后， 查看所有设备的channel，netid，netsize和sid |
| 预期结果     | 设备的channel， netid，netsize是一致，sid也没有冲突，节点间能相互ping通                                                                             |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                          |

### 长时间测试—AP长时间断网再连网后mesh网络存在

| 测试用例编号 | AOS-2-52                                                                                                                                          |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 长时间测试—AP长时间断网再连网后mesh网络存在                                                                                                       |
| 测试目的     | 验证AP长时间断网再连网后mesh网络存在                                                                                                              |
| 测试属性     | 必选\| P1 \| 性能用例                                                                                                                             |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                          |
| 测试拓扑结构 | \- leader连接AP，其它节点不连接AP <br>- 设备的拓扑模式Leader+3router                                                                                |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                        |
| 测试步骤     | \- 所有设备都上电，且都处于mesh环境中 <br>- 将AP网络长时间断开12h后，再给AP连接网络 <br>- 等待一段时间后， 查看所有设备的channel，netid，netsize和sid |
| 预期结果     | 设备的channel， netid，netsize是一致，sid也没有冲突，节点间能相互ping通                                                                           |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                        |

### 稳定性测试—5\*24小时长时间挂机测试

| 测试用例编号 | AOS-2-53                                                                                                                                        |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 稳定性测试—5\*24小时长时间挂机测试                                                                                                              |
| 测试目的     | 验证设备的mesh运行5\*24小时仍然正常工作                                                                                                         |
| 测试属性     | 必选\| P0 \| 稳定性用例                                                                                                                         |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                        |
| 测试拓扑结构 | 设备配网成功，且形成了mesh网络，拓扑结构随意（例如 leader+6router： <br>0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000）            |
| 测试预置条件 | 同上                                                                                                                                            |
| 测试步骤     | 所有设备形成的mesh网络放置5\*24小时                                                                                                             |
| 预期结果     | Mesh网络仍然存在，没有设备重启，crash，掉线等。设备间能够ping通                                                                                 |
| 备注         | \- 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 <br>- 多级跳节点需要白名单来支持 <br>- 802.15.4组网、BLE组网（此2种组网功能暂无） |

### 复杂组网—各节点间能相互ping通

| 测试用例编号 | AOS-2-54                                                                                                                                                                         |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 复杂组网—各节点间能相互ping通                                                                                                                                                    |
| 测试目的     | 验证网络中的各节点间是否能相互ping通                                                                                                                                             |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                                            |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                         |
| 测试拓扑结构 | 所有设备组成一个mesh网络（leader+6router），请见附录B <br> 【0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000】                                                            |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                                                       |
| 测试步骤     | 所有节点相互ping各自的IP地址【例：ping 10.0.16.2（ipv4地址）<br> 或者ping fc00:0:0:6800:0:10（ipv6地址）】                                                                        |
| 预期结果     | 所有节点间都能ping通，能收到对应节点回复打印                                                                                                                                     |
| 备注         | \- 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 <br>- 多级跳节点需要白名单来支持 <br>- 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- **目前暂只支持ipv4地址网络** |

### 复杂组网—各节点间能相互ping长字节

| 测试用例编号 | AOS-2-55                                                                                                                                                                         |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 复杂组网—各节点间能相互ping长字节                                                                                                                                                |
| 测试目的     | 验证网络中的各节点间是否能相互ping通长字节                                                                                                                                       |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                                            |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                         |
| 测试拓扑结构 | 所有设备组成一个mesh网络（leader+6router），请见附录B <br> 【0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000】                                                            |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                                                       |
| 测试步骤     | 所有节点相互长字节ping各自的IP地址【例：ping 10.0.16.2 1000（ipv4地址）<br> 或者 ping fc00:0:0:6800:0:1000 1000（ipv6地址）】                                                     |
| 预期结果     | 所有节点间都能ping通，能收到对应节点回复打印                                                                                                                                     |
| 备注         | \- 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 <br>- 多级跳节点需要白名单来支持 <br>- 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- **目前暂只支持ipv4地址网络** |

### 复杂组网—ping全网广播

| 测试用例编号 | AOS-2-56                                                                                                                                                                                                          |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 复杂组网—ping全网广播                                                                                                                                                                                             |
| 测试目的     | 验证网络中的ping全网广播后所有节点是否都收到                                                                                                                                                                      |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                                                                             |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                          |
| 测试拓扑结构 | 所有设备组成一个mesh网络（leader+6router），请见附录B <br> 【0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000】                                                                                             |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                                                                                        |
| 测试步骤     | \- 每个节点上分别执行ping 224.0.0.252 <br>- 每个节点上执行指定长度的广播，执行命令是ping 224.0.0.252 X（ipv4地址）<br> 或者ping ff08:0:0:fffe:0:0:0:fc X（ipv6地址）                                                 |
| 预期结果     | \- 能够正常ping通，能收到所有节点回复打印 <br>- 能够正常ping通，能收到所有节点回复打印。                                                                                                                            |
| 备注         | \- 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 <br>- 多级跳节点需要白名单来支持、 <br>- X为字节长度，范围在1\~1492 <br>- 802.15.4组网、BLE组网（此2种组网功能暂无） <br>- **目前暂只支持ipv4地址网络** |

### 复杂组网—AP断网再联网，mesh网络保持不变

| 测试用例编号 | AOS-2-57                                                                                                                                        |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 复杂组网—AP断网再联网，mesh网络保持不变                                                                                                         |
| 测试目的     | 验证断网后再联网，mesh网络是否变化                                                                                                              |
| 测试属性     | 必选\| P1 \| 性能用例                                                                                                                           |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                        |
| 测试拓扑结构 | 所有设备组成一个mesh网络（leader+6router），请见附录B <br> 【0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000】                           |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                      |
| 测试步骤     | AP断网后再联网                                                                                                                                |
| 预期结果     | 等待5分钟后mesh网络的拓扑结构不变，设备能响应APP的下行操作，节点间能够相互通信                                                                  |
| 备注         | \- 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 <br>- 多级跳节点需要白名单来支持 <br>- 802.15.4组网、BLE组网（此2种组网功能暂无） |

### 复杂组网—AP断电再上电，mesh网络保持不变

| 测试用例编号 | AOS-2-58                                                                                                                                        |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 复杂组网—AP断电再上电，mesh网络保持不变                                                                                                         |
| 测试目的     | 验证AP断电再上电，mesh网络是否变化                                                                                                              |
| 测试属性     | 必选\| P1 \| 性能用例                                                                                                                           |
| 测试设备     | 1.设备，2.无线路由器，3.PC ，4.手机                                                                                                             |
| 测试拓扑结构 | 所有设备组成一个mesh网络（leader+6router），请见附录B <br> 【0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000】                           |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                      |
| 测试步骤     | AP断电后再上电                                                                                                                                 |
| 预期结果     | 等待8分钟后mesh网络的拓扑结构不变，设备能响应APP的下行操作，节点间能够相互通信                                                                  |
| 备注         | \- 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 <br>- 多级跳节点需要白名单来支持 <br>- 802.15.4组网、BLE组网（此2种组网功能暂无） |

### 复杂组网—12H长时间AP断网后再联网，mesh网络保持不变

| 测试用例编号 | AOS-2-59                                                                                                                                        |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 复杂组网—12H长时间AP断网后再联网，mesh网络保持不变                                                                                              |
| 测试目的     | 验证12H长时间断网后再联网，mesh网络是否变化                                                                                                     |
| 测试属性     | 必选\| P1 \| 稳定性用例                                                                                                                         |
| 测试设备     | 1.设备，2.无线路由器，3.PC ，4.手机                                                                                                             |
| 测试拓扑结构 | 所有设备组成一个mesh网络（leader+6router），请见附录B <br> 【0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000】                           |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                      |
| 测试步骤     | AP断网，12H后再联网                                                                                                                               |
| 预期结果     | 等待5分钟后mesh网络的拓扑结构不变，设备能响应APP操作，节点间能够相互通信                                                                        |
| 备注         | \- 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 <br>- 多级跳节点需要白名单来支持 <br>- 802.15.4组网、BLE组网（此2种组网功能暂无） |

### 复杂组网—12H长时间AP断电后再上电，mesh网络保持不变

| 测试用例编号 | AOS-2-60                                                                                                                                        |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 复杂组网—12H长时间AP断电后再上电，mesh网络保持不变                                                                                              |
| 测试目的     | 验证AP断电12H再上电，mesh网络是否变化                                                                                                           |
| 测试属性     | 必选\| P1 \| 稳定性用例                                                                                                                         |
| 测试设备     | 1.设备，2.无线路由器，3.PC ，4.手机                                                                                                             |
| 测试拓扑结构 | 所有设备组成一个mesh网络（leader+6router），请见附录B <br>【0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000】                           |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                      |
| 测试步骤     | AP断网后12H再联网                                                                                                                               |
| 预期结果     | 等待8分钟后mesh网络的拓扑结构不变，设备能响应APP操作，节点间能够相互通信                                                                        |
| 备注         | \- 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 <br>- 多级跳节点需要白名单来支持 <br>- 802.15.4组网、BLE组网（此2种组网功能暂无） |